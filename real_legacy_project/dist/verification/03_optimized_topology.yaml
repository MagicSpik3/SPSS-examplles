# Pipeline Topology: 29 Operations
----------------------------------------
Operation: op_001_load
  Type:    LOAD_CSV
  Inputs:  []
  Outputs: ['source_control_vars.csv']
  Params:  {'filename': 'control_vars.csv', 'format': 'TXT'}

Operation: batch_op_002_compute
  Type:    BATCH_COMPUTE
  Inputs:  ['source_control_vars.csv']
  Outputs: ['ds_015_derived']
  Params:  {'computes': [{'target': 'min_age_n', 'expression': '$SYSMIS'}, {'target': 'max_age_n', 'expression': '$SYSMIS'}, {'target': 'reference_month_n', 'expression': '$SYSMIS'}, {'target': 'min_age_n', 'expression': 'NUMBER ( value , F3.0 )'}, {'target': 'max_age_n', 'expression': 'NUMBER ( value , F3.0 )'}, {'target': 'reference_month_n', 'expression': 'NUMBER ( value , F6.0 )'}, {'target': 'exclude_status_s', 'expression': 'value'}]}

Operation: op_018_exec
  Type:    MATERIALIZE
  Inputs:  ['ds_015_derived']
  Outputs: ['ds_017_materialized']

Operation: op_019_filter
  Type:    FILTER_ROWS
  Inputs:  ['ds_017_materialized']
  Outputs: ['ds_018_filtered']
  Params:  {'condition': 'NOT MISSING ( min_age_n )'}

Operation: op_020_compute
  Type:    COMPUTE_COLUMNS
  Inputs:  ['ds_018_filtered']
  Outputs: ['ds_019_derived']
  Params:  {'target': 'join_key', 'expression': '1'}

Operation: op_021_exec
  Type:    MATERIALIZE
  Inputs:  ['ds_019_derived']
  Outputs: ['ds_020_materialized']

Operation: op_022_save
  Type:    SAVE_BINARY
  Inputs:  ['ds_020_materialized']
  Outputs: ['file_control_values.sav']
  Params:  {'filename': 'control_values.sav'}

Operation: op_023_load
  Type:    LOAD_CSV
  Inputs:  []
  Outputs: ['source_benefit_rates.csv']
  Params:  {'filename': 'benefit_rates.csv', 'format': 'TXT'}

Operation: op_024_sort
  Type:    SORT_ROWS
  Inputs:  ['source_benefit_rates.csv']
  Outputs: ['ds_021_sorted']
  Params:  {'keys': 'benefit_type'}

Operation: op_025_save
  Type:    SAVE_BINARY
  Inputs:  ['ds_021_sorted']
  Outputs: ['file_benefit_rates.sav']
  Params:  {'filename': 'benefit_rates.sav'}

Operation: op_026_load
  Type:    LOAD_CSV
  Inputs:  []
  Outputs: ['source_claims_data.csv']
  Params:  {'filename': 'claims_data.csv', 'format': 'TXT'}

Operation: op_027_compute
  Type:    COMPUTE_COLUMNS
  Inputs:  ['source_claims_data.csv']
  Outputs: ['ds_022_derived']
  Params:  {'target': 'join_key', 'expression': '1'}

Operation: op_028_exec
  Type:    MATERIALIZE
  Inputs:  ['ds_022_derived']
  Outputs: ['ds_023_materialized']

Operation: op_029_join
  Type:    JOIN
  Inputs:  ['ds_023_materialized', 'file_control_values.sav']
  Outputs: ['ds_024_joined']
  Params:  {'by': 'join_key'}

Operation: op_030_exec
  Type:    MATERIALIZE
  Inputs:  ['ds_024_joined']
  Outputs: ['ds_025_materialized']

Operation: batch_op_031_compute
  Type:    BATCH_COMPUTE
  Inputs:  ['ds_025_materialized']
  Outputs: ['ds_034_derived']
  Params:  {'computes': [{'target': 'dob_num', 'expression': 'NUMBER ( dob , F8.0 )'}, {'target': 'claim_start_num', 'expression': 'NUMBER ( claim_start , F8.0 )'}, {'target': 'claim_end_num', 'expression': 'NUMBER ( claim_end , F8.0 )'}, {'target': 'dob_date', 'expression': 'DATE.MDY ( TRUNC ( MOD ( dob_num , 10000 ) / 100 ) , MOD ( dob_num , 100 ) , TRUNC ( dob_num / 10000 ) )'}, {'target': 'claim_start_date', 'expression': 'DATE.MDY ( TRUNC ( MOD ( claim_start_num , 10000 ) / 100 ) , MOD ( claim_start_num , 100 ) , TRUNC ( claim_start_num / 10000 ) )'}, {'target': 'claim_end_date', 'expression': 'DATE.MDY ( TRUNC ( MOD ( claim_end_num , 10000 ) / 100 ) , MOD ( claim_end_num , 100 ) , TRUNC ( claim_end_num / 10000 ) )'}, {'target': 'age_years', 'expression': 'TRUNC ( ( claim_start_date - dob_date ) / ( 365.25 * 86400 ) )'}, {'target': 'age_valid', 'expression': '1'}]}

Operation: op_040_generic
  Type:    FILTER_ROWS
  Inputs:  ['ds_034_derived']
  Outputs: ['ds_035_generic']
  Params:  {'condition': 'unknown'}

Operation: op_041_generic
  Type:    FILTER_ROWS
  Inputs:  ['ds_035_generic']
  Outputs: ['ds_036_generic']
  Params:  {'condition': 'unknown'}

Operation: op_042_compute
  Type:    COMPUTE_COLUMNS
  Inputs:  ['ds_036_generic']
  Outputs: ['ds_037_derived']
  Params:  {'target': 'status_valid', 'expression': '1'}

Operation: op_043_generic
  Type:    FILTER_ROWS
  Inputs:  ['ds_037_derived']
  Outputs: ['ds_038_generic']
  Params:  {'condition': 'unknown'}

Operation: batch_op_044_compute
  Type:    BATCH_COMPUTE
  Inputs:  ['ds_038_generic']
  Outputs: ['ds_045_derived']
  Params:  {'computes': [{'target': 'ref_year', 'expression': 'TRUNC ( reference_month_n / 100 )'}, {'target': 'ref_month', 'expression': 'MOD ( reference_month_n , 100 )'}, {'target': 'month_start', 'expression': 'DATE.MDY ( ref_month , 1 , ref_year )'}, {'target': 'month_end', 'expression': 'DATE.MDY ( ref_month + 1 , 1 , ref_year ) - 1'}, {'target': 'eligible_start', 'expression': 'MAX ( claim_start_date , month_start )'}, {'target': 'eligible_end', 'expression': 'MIN ( claim_end_date , month_end )'}, {'target': 'eligible_days', 'expression': '( eligible_end - eligible_start ) / 86400 + 1'}]}

Operation: op_051_generic
  Type:    FILTER_ROWS
  Inputs:  ['ds_045_derived']
  Outputs: ['ds_046_generic']
  Params:  {'condition': 'unknown'}

Operation: op_052_sort
  Type:    SORT_ROWS
  Inputs:  ['ds_046_generic']
  Outputs: ['ds_047_sorted']
  Params:  {'keys': 'benefit_type'}

Operation: op_053_join
  Type:    JOIN
  Inputs:  ['ds_047_sorted', 'file_benefit_rates.sav']
  Outputs: ['ds_048_joined']
  Params:  {'by': 'benefit_type'}

Operation: op_054_exec
  Type:    MATERIALIZE
  Inputs:  ['ds_048_joined']
  Outputs: ['ds_049_materialized']

Operation: batch_op_055_compute
  Type:    BATCH_COMPUTE
  Inputs:  ['ds_049_materialized']
  Outputs: ['ds_051_derived']
  Params:  {'computes': [{'target': 'daily_rate', 'expression': 'weekly_rate / 7'}, {'target': 'payment_amount', 'expression': 'eligible_days * daily_rate'}]}

Operation: op_057_filter
  Type:    FILTER_ROWS
  Inputs:  ['ds_051_derived']
  Outputs: ['ds_052_filtered']
  Params:  {'condition': '( age_valid = 1 AND status_valid = 1 AND eligible_days > 0 )'}

Operation: op_058_aggregate
  Type:    AGGREGATE
  Inputs:  ['ds_052_filtered']
  Outputs: ['ds_053_agg_active']
  Params:  {'outfile': '*', 'break': ['benefit_type', 'region'], 'aggregations': ['TOTAL_PAID = SUM ( payment_amount )']}

Operation: op_059_save
  Type:    SAVE_BINARY
  Inputs:  ['ds_053_agg_active']
  Outputs: ['file_benefit_monthly_summary.csv']
  Params:  {'filename': 'benefit_monthly_summary.csv'}
